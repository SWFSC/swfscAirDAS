
<!-- README.md is generated from README.Rmd. Please edit that file -->

# swfscAirDAS

<!-- badges: start -->

[![Travis build
status](https://travis-ci.com/smwoodman/swfscAirDAS.svg?branch=master)](https://travis-ci.com/smwoodman/swfscAirDAS)
[![AppVeyor build
status](https://ci.appveyor.com/api/projects/status/github/smwoodman/swfscAirDAS?branch=master&svg=true)](https://ci.appveyor.com/project/smwoodman/swfscAirDAS)
<!-- badges: end -->

Warning: swfscAirDAS is still under development\! Please consult with
the author (<sam.woodman@noaa.gov>) before using it.

This package contains functions designed for processing and analyzing
aerial survey DAS data (AirDAS) generated by the Southwest Fisheries
Science Center using one of the following programs: PHOCOENA, CARETTA,
or TURTLE (such as TURTLEP or TURTLE4D). Functionality includes reading
AirDAS data into a data frame, processing this data (extracting state
and condition information for each AirDAS event), and summarizing
sighting and effort information. Plans for future development include:
generating tables summarizing the information in the AirDAS file,
plotting AirDAS data, and generating files needed for doing density
estimation.

## Installation

You can install `swfscAirDAS` from [GitHub](https://github.com) with:

``` r
# install.packages("remotes")
# Install remote dependency
remotes::install_github("smwoodman/swfscDAS")

# Install package
remotes::install_github("smwoodman/swfscAirDAS", build_vignettes = TRUE)
```

## AirDAS format and checks

`swfscAirDAS` accepts AirDAS data from several different programs, and
thus in several different formats: PHOCOENA, SURVEY (in the future),
CARETTA, and TURTLE. You can download PDFs describing these formats at
the following links:

  - [PHOCOENA data format
    PDF](https://github.com/smwoodman/swfscAirDAS/blob/master/inst/AirDAS_Format_PHOCOENA.pdf)
  - [CARETTA data format
    PDF](https://github.com/smwoodman/swfscAirDAS/blob/master/inst/AirDAS_Format_CARETTA.pdf)
  - [TURTLE data format
    PDF](https://github.com/smwoodman/swfscAirDAS/blob/master/inst/AirDAS_Format_TURTLE.pdf)

These PDFs are also included in the package; see
[`airdas_format_pdf`](https://smwoodman.github.io/swfscAirDAS/reference/airdas_format_pdf.html)
for more details.

In addition, the package contains the function
[`airdas_check`](https://smwoodman.github.io/swfscAirDAS/reference/airdas_check.html),
which checks whether the provided file adheres to expected format of the
provided file type. This function is designed to 1) be used for data
QA/QC after performing a survey and 2) ensure the data format meets all
of the assumptions made by the rest of the functions in the packge. A
PDF describing the format checks is included in the package; you can
also [`download the PDF
here`](https://github.com/smwoodman/swfscAirDAS/blob/master/inst/AirDAS_check.pdf)

## Usage

First, you must read and process the AirDAS data

``` r
library(swfscAirDAS)
# Get file paths of sample files included in the package
y <- system.file("airdas_sample.das", package = "swfscAirDAS")

# Read and process AirDAS file, i.e. read AirDAS data into a data frame and add info columns
y.read <- airdas_read(y, file.type = "turtle", skip = 0)
y.proc <- airdas_process(y.read)

# Alternatively, the file path can be passed directly to airdas_process
y.proc <- airdas_process(y)
```

Note that `airdas_read` can read multiple files simultaneously

``` r
y.read.mult <- airdas_read(c(y, y))
```

After processing, you can summarize the processed AirDAS data sightings
and chop the continuous effort sections into effort segments.

``` r
# Summarize sighting information
y.sight <- airdas_sight(y.proc)

# Chop and summarize effort using "equallength" method
y.eff.randpicks <- system.file("airdas_sample_randpicks.csv", package = "swfscAirDAS")

y.eff <- airdas_effort(
  y.proc, method = "equallength", seg.km = 3, randpicks.load = y.eff.randpicks, 
  num.cores = 1
)
y.eff.sight <- airdas_effort_sight(y.eff, sp.codes = c("mn", "bm"))

y.segdata <- y.eff.sight[[1]]
y.siteinfo <- y.eff.sight[[2]]
y.randpicks <- y.eff.sight[[3]]

# Chop and summarize effort using "condition" method
y.eff.cond <- airdas_effort(
  y.proc, method = "condition", seg.min.km = 0.05, 
  num.cores = 1
)
y.eff.cond.sight <- airdas_effort_sight(y.eff.cond, sp.codes = c("mn", "bm"))
```

You can also check that your AirDAS data has accepted formatting and
values, as well as extract data from comments:

``` r
# Check formatting
y.check <- airdas_check(y, print.transect = FALSE)

# Paste comments back together
y.comments <- airdas_comments(y.proc)

# Extract data from comments
y.comments.data <- airdas_process_comments(y.proc)
```
